<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="robots" content="index">
    <title>중고 검색기</title>
    <script crossorigin src="./js/react.development.js"></script>
    <script crossorigin src="./js/react-dom.development.js"></script>
    <script crossorigin src="./js/babel.js"></script>

    <script crossorigin src="./js/jquery-3.5.1.js"></script>

    <script crossorigin src="./js/bootstrap.bundle.js"></script>
    <script crossorigin src="./js/bootstrap.js"></script>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-analytics.js"></script>

    <link rel="stylesheet" href="./css/bootstrap.css">
    <link rel="stylesheet" href="./css/bootstrap-grid.css">
    <link rel="stylesheet" href="./css/bootstrap-reboot.css">

    <meta name="theme-color" content="#563d7c">

    <meta name="author" content="jyk86">
    <meta name="description" content="모든 제품을 한번에 비교 검색할 수 있는 가격비교 사이트 입니다.">
    <meta property="og:title" content="가격비교 스케너: 간편한 가격 비교">
    <meta property="og:description" content="모든 중고 제품을 한번에 비교 검색할 수 있는 가격비교 사이트 입니다.">

    <link rel="canonical" href="https://wjd0r.github.io">

    <script data-ad-client="ca-pub-9815296081251834" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <style>
        /* 나눔 고딕 폰트 */
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@800&display=swap');

        .nanum-gothic {
            font-family: 'Nanum Gothic', sans-serif;
        }

        /* navbar 사라지지 않도록 */
        .navbar-expand-lg .navbar-collapse {
            display: -ms-flexbox !important;
            display: flex !important;
            -ms-flex-preferred-size: auto;
            flex-basis: auto;
        }

        .main {
            position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;
        }

        .table-striped tbody tr:hover {
            background-color: rgba(0,0,0,.1);
            cursor: pointer;
        }

        .txt_line { /* 텍스트 한줄로 */
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .fixed-top{
            margin-top: 200px;
        }

        .cheapest_finder {
            margin: 0 auto;
            max-width: 900px;
        }

        table tr > td {
            position: relative;
        }

        table tr > td > div:nth-child(1).content {
            display: inline-block;
            width: calc(100% - 116px);
        }

        table tr > td > div:nth-child(1).content > span:nth-child(2) {
            max-width: calc(100% - 70px);
            overflow: hidden;
            display: inline-grid;
            padding-right: 7px;
        }

        table tr > td > div:nth-child(2) {
            float: right;
            display: inline-block;
            box-sizing: border-box;
            height: 23px;
            position: absolute;
            top: 50%;
            margin-top: -11.5px;
            right: 12px;
        }
    </style>

</head>
<body>

<div id="root"></div>
<script type="text/babel">
    class PriceComparisonTop extends React.Component {
        constructor(props) {
            super(props);
            this.state = {
                query: '',
                items: [],
                jumbotronShow: false,
                jumbotronTitle: '스마트한 가격비교',
                jumbotronContent: '가격 비교 통한 똑똑한 소비',
            };
        }

        init = () => {
            this.setState((prevState) => {
                return {
                    jumbotronShow: false,
                    jumbotronTitle: '스마트한 가격비교',
                    jumbotronContent: '가격 비교 통한 똑똑한 소비',
                }
            });
        }

        onChange = (e) => {
            this.setState({query:e.target.value});
        }

        onFocus = (e) => {
            $('.form-control').css('width', '100%');
            $('.form-inline').css('width', '100%');
            $('.navbar-brand').css('display', 'none');

            this.setState((prevState) => {
                return {
                    jumbotronShow: true,
                    jumbotronTitle: 'Search 선택',
                    jumbotronContent: '검색어 입력 후 엔터를 눌러주세요.',
                }
            });
        }

        onFocusout = (e) => {
            $('.form-control').css('width', 'auto');
            $('.form-inline').css('width', 'auto');
            $('.navbar-brand').css('display', 'inline');

            this.init();
        }

        searchSubmit = async (e) => {
            e.preventDefault();

            this.init();

            /* 부모에게 데이터 넘김 */
            this.props.searchCallback({
                query: '',
                items: [],
            });

            this.setState((prevState) => {
                return {
                    jumbotronTitle: '검색중...',
                    jumbotronContent: 0,
                }
            });

            let progress_interval = setInterval(() => {
                this.setState((prevState) => {
                    return {
                        jumbotronContent: Number(Number(this.state.jumbotronContent) + 0.1).toFixed(1),
                    }
                })
            }, 100);

            await this.naverShopApi(this.state.query).then((response) => {
                this.setState((prevState) => {
                    return {
                        items: response.items,
                    }
                });
            });

            this.subProductType();

            clearInterval(progress_interval);

            /* 검색 완료 후 점보트론 안보이도록 */
            this.setState((prevState) => {
                return {
                    jumbotronShow: false,
                    query: '',
                }
            });

            /* 검색 완료 후 포커스 해제 */
            $(':focus').blur();

            /* 부모에게 데이터 넘김 */
            this.props.searchCallback(this.state);
        }

        subProductType = () => {
            let tempProductType = [];
            this.state.items.map(item => {
                if (item.productType == '1') {
                    tempProductType.push(item);
                }
            });

            this.setState((prevState) => {
                return {
                    items: tempProductType.length == 0 ? [{}] : tempProductType,
                }
            });
        }

        naverShopApi = (query) => new Promise(function(resolve, reject) {
            let request = new XMLHttpRequest();

            request.open('GET', 'http://3.21.35.236:8080/https://openapi.naver.com/v1/search/shop?query=' + query + '&display=100', true);
            request.setRequestHeader('X-Naver-Client-Id', 'E73v0xFMsyAGr9GrOcID');
            request.setRequestHeader('X-Naver-Client-Secret', 'uvWTcWYkCv');
            request.setRequestHeader('Origin', 'http://3.21.35.236:8080');

            request.onload = (e) => {
                if (request.status >= 200 && request.status < 400) {
                    let responseObject = JSON.parse(request.responseText);
                    resolve(responseObject);
                } else {
                    console.log('We reached our target server, but it returned an error');
                    console.log('Possibly handle the error by changing your state.');
                }
            };

            request.onerror = () => {
                console.log('There was a connection error of some sort.');
                console.log('Possibly handle the error by changing your state.');
                reject();
            };

            request.send();
        });

        render() {
            return (
                <React.Fragment>
                    <header>
                        <nav className="navbar navbar-expand-lg navbar-light bg-light rounded">
                            <a className="navbar-brand nanum-gothic" href="#" style={{color: 'var(--danger)'}}>가격비교 스케너</a>

                            <div className="collapse navbar-collapse" id="navbarsExample09">
                                <div className="navbar-nav mr-auto"></div>
                                <form className="form-inline my-2 my-md-0" onSubmit={this.searchSubmit}>
                                    <input className="form-control" type="text" placeholder="Search" aria-label="Search" onChange={this.onChange} value={this.state.query} onFocus={this.onFocus} onBlur={this.onFocusout}/>
                                </form>
                            </div>
                        </nav>
                    </header>
                    {this.state.jumbotronShow
                        ? <div style={{padding: '0.5rem 1rem'}}>
                            <div className="jumbotron">
                                <h1>{this.state.jumbotronTitle}</h1>
                                <p className="lead">{this.state.jumbotronContent}</p>
                            </div>
                        </div>
                        : null
                    }
                </React.Fragment>
            );
        }
    }
/*top******************************************************************************************************************************/
/*item******************************************************************************************************************************/
    class PriceComparisonItem extends React.Component {
        constructor(props) {
            super(props);
            this.state = {
                items: [],
            };
        }

        descriptionToCost = () => {
            let reals = [];
            this.state.items.map(item => {
                if (item.description.indexOf("가격") != -1 && item.description.indexOf("원") != -1 && item.description.indexOf("판매중") != -1 && item.description.indexOf("매입") == -1 ) {
                    item.cost = item.description.split("가격")[1].split("원")[0].replace(/,/gi, "").replace(/ /g,"") * 1;
                    if (item.description.indexOf("판매중") != -1) item.type = "판매중";
                    if (item.description.indexOf("판매완료") != -1) item.type = "판매완료";
                    if (item.description.indexOf("예약중") != -1) item.type = "예약중";

                    reals.push(item);
                }
            });

            reals.sort((a, b) => a.cost < b.cost ? -1 : a.cost > b.cost ? 1 : 0);

            this.setState((prevState) => {
                return {
                    items: reals.length == 0 ? [{}] : reals,
                }
            });
        }

        naverCafeApi = () => {
            let request = new XMLHttpRequest();

            request.open('GET', 'http://3.21.35.236:8080/https://openapi.naver.com/v1/search/cafearticle?query=' + this.props.item.title.replace(/<b>/gi, "").replace(/<\/b>/gi, "") + '&display=100&start=1&sort=sim', true);
            request.setRequestHeader('X-Naver-Client-Id', 'E73v0xFMsyAGr9GrOcID');
            request.setRequestHeader('X-Naver-Client-Secret', 'uvWTcWYkCv');
            request.setRequestHeader('Origin', 'http://3.21.35.236:8080');

            console.log('naver api 호출 !!!');

            request.onload = (e) => {
                if (request.status >= 200 && request.status < 400) {
                    let responseObject = JSON.parse(request.responseText);

                    console.log(responseObject.items);

                    this.setState((prevState) => {
                        return {
                            items: responseObject.items,
                        }
                    });
                    this.descriptionToCost();
                } else {
                    console.log('We reached our target server, but it returned an error');
                    console.log('Possibly handle the error by changing your state.');
                }
            };

            request.onerror = () => {
                console.log('There was a connection error of some sort.');
                console.log('Possibly handle the error by changing your state.');
                reject();
            };

            request.send();
        };

        numberWithCommas = (x) => x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

        render() {
            return (
                <div className="shadow-lg card p-2 mb-2 bg-white rounded">
                    {!this.props.item.title
                        ? <div>
                            검색된 물품이 없습니다.
                        </div>
                        : <div>
                            <div className="no-gutters">
                                <div className="">
                                    <img src={this.props.item.image} className="rounded float-left mr-2" height="82" width="82" />
                                </div>

                                <span className="badge badge-secondary">{this.props.item.maker}</span>&nbsp;
                                <span className="badge badge-secondary">{this.props.item.brand}</span>&nbsp;
                                <span className="badge badge-secondary">{this.props.item.category1}</span>&nbsp;
                                <p className="h6">{this.props.item.title.replace(/<b>/gi, "").replace(/<\/b>/gi, "")}</p>
                                <div className="" style={{'display':'flex'}}>
                                    <div className="mr-auto">
                                        <strong className="h5 nanum-gothic" style={{color:'var(--danger)'}}>{this.numberWithCommas(this.props.item.lprice)}원</strong>
                                    </div>
                                    <span>
                                <button type="button" className="btn btn-danger btn-sm"
                                        data-toggle="collapse"
                                        href={"#collapse"+this.props.item.productId}
                                        role="button"
                                        aria-expanded="false"
                                        aria-controls={"collapse"+this.props.item.productId}
                                        onClick={this.naverCafeApi}
                                >중고 시세</button>&nbsp;
                            </span>
                                </div>
                            </div>

                            <div id={"collapse"+this.props.item.productId} className="collapse multi-collapse mt-2">
                                <div className="table-responsive">
                                    <table className="table table-striped mb-0">
                                        <tbody>
                                        {this.state.items.length != 0
                                            ? this.state.items.map(item => {
                                                return (
                                                    <PriceComparisonItemItem item={item}></PriceComparisonItemItem>
                                                )
                                            })
                                            : <tr>
                                                <td className="align-middle m-1" style={{'text-align': 'center', color:'var(--danger)'}}>
                                                    <div className="spinner-border" role="status">
                                                        <span className="sr-only">Loading...</span>
                                                    </div> <strong className="h5">Loading...</strong>
                                                </td>
                                            </tr>
                                        }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            );
        }
    }
/*item******************************************************************************************************************************/
/*item>item******************************************************************************************************************************/
    class PriceComparisonItemItem extends React.Component {
        constructor(props) {
            super(props);

            this.state = {
                item: [],
            };
        }

        numberWithCommas = (x) => x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

        render() {
            console.log(this.props.item);
            console.log(this.props.item.title);
            return (
                <tr onClick={() => window.open(this.props.item.link ,'_blank')}>
                {!this.props.item.title
                    ? <td>
                        <div>
                            현제 판매중인 중고 물품이 없습니다.
                        </div>
                    </td>
                    : <td>
                        <div className="content"><span className="badge badge-success">{this.props.item.type}</span>&nbsp;
                            <span className="badge badge-primary">{this.props.item.cafename}</span><br/>
                            <span>{this.props.item.title.replace(/<b>/gi, "").replace(/<\/b>/gi, "").replace(/&lt;/g,"").replace(/&gt;/g,"")}</span>
                        </div>
                        <div className="txt_line align-middle text-right">
                            <strong className="h5 nanum-gothic" style={{color:'var(--danger)'}}>{this.numberWithCommas(String(this.props.item.cost))}원</strong>
                        </div>
                    </td>
                }
                </tr>
            );
        }
    }
/*item>item******************************************************************************************************************************/
/*******************************************************************************************************************************/
    class PriceComparison extends React.Component {
        constructor(props) {
            super(props);

            this.state = {
                query: '',
                lastBuildDate: '',
                total: '',
                start: '',
                display: '',
                newItems: [{"title":"Apple <b>아이폰</b> 12 128GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24452875523","image":"https://shopping-phinf.pstatic.net/main_2445287/24452875523.20201021164731.jpg","lprice":"1159950","hprice":"1920000","mallName":"네이버","productId":"24452875523","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 11 64GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=20858274131","image":"https://shopping-phinf.pstatic.net/main_2085827/20858274131.20200602133347.jpg","lprice":"946400","hprice":"1584000","mallName":"네이버","productId":"20858274131","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 12 미니 128GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24452740523","image":"https://shopping-phinf.pstatic.net/main_2445274/24452740523.20201112165640.jpg","lprice":"1020000","hprice":"1295200","mallName":"네이버","productId":"24452740523","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 12 미니 64GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24450995542","image":"https://shopping-phinf.pstatic.net/main_2445099/24450995542.20201112165405.jpg","lprice":"950000","hprice":"1207000","mallName":"네이버","productId":"24450995542","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 11 128GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=20858302247","image":"https://shopping-phinf.pstatic.net/main_2085830/20858302247.20200602150427.jpg","lprice":"1059980","hprice":"1716000","mallName":"네이버","productId":"20858302247","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 12 프로 맥스 256GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24453167522","image":"https://shopping-phinf.pstatic.net/main_2445316/24453167522.20201112164653.jpg","lprice":"1776960","hprice":"1829900","mallName":"네이버","productId":"24453167522","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> SE2 64GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=22520082057","image":"https://shopping-phinf.pstatic.net/main_2252008/22520082057.20200826155622.jpg","lprice":"492800","hprice":"1000000","mallName":"네이버","productId":"22520082057","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 12 64GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24452854524","image":"https://shopping-phinf.pstatic.net/main_2445285/24452854524.20201021164436.jpg","lprice":"1079990","hprice":"1728000","mallName":"네이버","productId":"24452854524","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 12 256GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24452854525","image":"https://shopping-phinf.pstatic.net/main_2445285/24452854525.20201021165031.jpg","lprice":"1300000","hprice":"2112000","mallName":"네이버","productId":"24452854525","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 11 프로 256G [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=20858389068","image":"https://shopping-phinf.pstatic.net/main_2085838/20858389068.20200603175350.jpg","lprice":"1379980","hprice":"2295480","mallName":"네이버","productId":"20858389068","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 12 미니 256GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24452857526","image":"https://shopping-phinf.pstatic.net/main_2445285/24452857526.20201112165858.jpg","lprice":"1160000","hprice":"1340230","mallName":"네이버","productId":"24452857526","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b>XR 128GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=16043576394","image":"https://shopping-phinf.pstatic.net/main_1604357/16043576394.20190516175026.jpg","lprice":"1","hprice":"1056000","mallName":"네이버","productId":"16043576394","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>12 프로 256GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24452731530","image":"https://shopping-phinf.pstatic.net/main_2445273/24452731530.20201021170954.jpg","lprice":"1725630","hprice":"2200000","mallName":"네이버","productId":"24452731530","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b>XR 128GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=16045915885","image":"https://shopping-phinf.pstatic.net/main_1604591/16045915885.20190208110438.jpg","lprice":"43500","hprice":"930700","mallName":"네이버","productId":"16045915885","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b> 12 프로 맥스 128GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24453088526","image":"https://shopping-phinf.pstatic.net/main_2445308/24453088526.20201112164358.jpg","lprice":"1667240","hprice":"1692150","mallName":"네이버","productId":"24453088526","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 11 프로 64G [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=20858385976","image":"https://shopping-phinf.pstatic.net/main_2085838/20858385976.20200603173253.jpg","lprice":"1038990","hprice":"2200000","mallName":"네이버","productId":"20858385976","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 11 프로 맥스 256G [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=20858568204","image":"https://shopping-phinf.pstatic.net/main_2085856/20858568204.20200604141433.jpg","lprice":"1490000","hprice":"2399800","mallName":"네이버","productId":"20858568204","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 11 128GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=20858301696","image":"https://shopping-phinf.pstatic.net/main_2085830/20858301696.20190911112519.jpg","lprice":"515990","hprice":"981900","mallName":"네이버","productId":"20858301696","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 11 64GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=20858274127","image":"https://shopping-phinf.pstatic.net/main_2085827/20858274127.20200115153019.jpg","lprice":"450000","hprice":"990000","mallName":"네이버","productId":"20858274127","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 12 프로 512GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24453088524","image":"https://shopping-phinf.pstatic.net/main_2445308/24453088524.20201117162613.jpg","lprice":"1760000","hprice":"2400000","mallName":"네이버","productId":"24453088524","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b>XR 64GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=16041803490","image":"https://shopping-phinf.pstatic.net/main_1604180/16041803490.20190111113606.jpg","lprice":"1","hprice":"864700","mallName":"네이버","productId":"16041803490","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b>X 64GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=12725335936","image":"https://shopping-phinf.pstatic.net/main_1272533/12725335936.20180607174129.jpg","lprice":"93170","hprice":"847000","mallName":"네이버","productId":"12725335936","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b>XR 64GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=16043524133","image":"https://shopping-phinf.pstatic.net/main_1604352/16043524133.20181109115027.jpg","lprice":"39500","hprice":"990000","mallName":"네이버","productId":"16043524133","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>XS 256GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=15979048279","image":"https://shopping-phinf.pstatic.net/main_1597904/15979048279.20190208142354.jpg","lprice":"1000","hprice":"1521800","mallName":"네이버","productId":"15979048279","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b> 12 프로 128GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24452979523","image":"https://shopping-phinf.pstatic.net/main_2445297/24452979523.20201021170652.jpg","lprice":"1563840","hprice":"1701000","mallName":"네이버","productId":"24452979523","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 11 64GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=20858164661","image":"https://shopping-phinf.pstatic.net/main_2085816/20858164661.20200714152438.jpg","lprice":"450000","hprice":"1078000","mallName":"네이버","productId":"20858164661","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b> 11 프로 맥스 64G [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=20858502859","image":"https://shopping-phinf.pstatic.net/main_2085850/20858502859.20200604140323.jpg","lprice":"1299000","hprice":"2000000","mallName":"네이버","productId":"20858502859","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b>XS 256GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=16044767575","image":"https://shopping-phinf.pstatic.net/main_1604476/16044767575.20190516171250.jpg","lprice":"497800","hprice":"1497600","mallName":"네이버","productId":"16044767575","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 12 미니 128GB [SKT]","link":"https://search.shopping.naver.com/gate.nhn?id=24451151531","image":"https://shopping-phinf.pstatic.net/main_2445115/24451151531.20201014113043.jpg","lprice":"853300","hprice":"1020000","mallName":"네이버","productId":"24451151531","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 12 프로 128GB [SKT]","link":"https://search.shopping.naver.com/gate.nhn?id=24452797524","image":"https://shopping-phinf.pstatic.net/main_2445279/24452797524.20201014120839.jpg","lprice":"1183300","hprice":"1221220","mallName":"네이버","productId":"24452797524","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>XS 64GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=16044630055","image":"https://shopping-phinf.pstatic.net/main_1604463/16044630055.20181109142618.jpg","lprice":"448300","hprice":"1299600","mallName":"네이버","productId":"16044630055","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 11 Pro 256GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=20858388549","image":"https://shopping-phinf.pstatic.net/main_2085838/20858388549.20190911115936.jpg","lprice":"1044000","hprice":"1584000","mallName":"네이버","productId":"20858388549","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>XR 256GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=16044502209","image":"https://shopping-phinf.pstatic.net/main_1604450/16044502209.20190208110240.jpg","lprice":"39500","hprice":"1188000","mallName":"네이버","productId":"16044502209","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>XS Max 64GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=16045202761","image":"https://shopping-phinf.pstatic.net/main_1604520/16045202761.20181109150738.jpg","lprice":"497800","hprice":"1496000","mallName":"네이버","productId":"16045202761","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 11 128GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=20858277032","image":"https://shopping-phinf.pstatic.net/main_2085827/20858277032.20190911112213.jpg","lprice":"696000","hprice":"1056000","mallName":"네이버","productId":"20858277032","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b>XS 64GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=15978139312","image":"https://shopping-phinf.pstatic.net/main_1597813/15978139312.20190208103148.jpg","lprice":"1238690","hprice":"1364000","mallName":"네이버","productId":"15978139312","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b> 12 프로 맥스 512GB [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=24452733534","image":"https://shopping-phinf.pstatic.net/main_2445273/24452733534.20201112164904.jpg","lprice":"2045450","hprice":"2058110","mallName":"네이버","productId":"24452733534","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b>XS Max 256GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=16045527823","image":"https://shopping-phinf.pstatic.net/main_1604552/16045527823.20181109151335.jpg","lprice":"547300","hprice":"1705000","mallName":"네이버","productId":"16045527823","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>7 32G [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=17071562147","image":"https://shopping-phinf.pstatic.net/main_1707156/17071562147.20200211125443.jpg","lprice":"255900","hprice":"299000","mallName":"네이버","productId":"17071562147","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b>XS Max 256GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=15992078922","image":"https://shopping-phinf.pstatic.net/main_1599207/15992078922.20190208142914.jpg","lprice":"597400","hprice":"1664800","mallName":"네이버","productId":"15992078922","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b>X 64G (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=12725272918","image":"https://shopping-phinf.pstatic.net/main_1272527/12725272918.20180504170400.jpg","lprice":"643300","hprice":"1220400","mallName":"네이버","productId":"12725272918","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 12 프로 256GB [SKT]","link":"https://search.shopping.naver.com/gate.nhn?id=24452569534","image":"https://shopping-phinf.pstatic.net/main_2445256/24452569534.20201014121210.jpg","lprice":"1315300","hprice":"1315300","mallName":"네이버","productId":"24452569534","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 12 프로 맥스 256GB [SKT]","link":"https://search.shopping.naver.com/gate.nhn?id=24453107524","image":"https://shopping-phinf.pstatic.net/main_2445310/24453107524.20201014123847.jpg","lprice":"1447300","hprice":"1630000","mallName":"네이버","productId":"24453107524","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 11 64GB (LG U+)","link":"https://search.shopping.naver.com/gate.nhn?id=20858274130","image":"https://shopping-phinf.pstatic.net/main_2085827/20858274130.20190911111917.jpg","lprice":"699500","hprice":"990000","mallName":"네이버","productId":"20858274130","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"LG U+","category4":""},{"title":"Apple <b>아이폰</b> 12 미니 64GB [SKT]","link":"https://search.shopping.naver.com/gate.nhn?id=24452568526","image":"https://shopping-phinf.pstatic.net/main_2445256/24452568526.20201014112112.jpg","lprice":"787300","hprice":"950000","mallName":"네이버","productId":"24452568526","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 11 Pro 64GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=20858385412","image":"https://shopping-phinf.pstatic.net/main_2085838/20858385412.20200115152611.jpg","lprice":"951800","hprice":"1554000","mallName":"네이버","productId":"20858385412","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> SE2 256GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=22520091184","image":"https://shopping-phinf.pstatic.net/main_2252009/22520091184.20200417144940.jpg","lprice":"293790","hprice":"699000","mallName":"네이버","productId":"22520091184","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> SE2 128GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=22520082058","image":"https://shopping-phinf.pstatic.net/main_2252008/22520082058.20200417144513.jpg","lprice":"264700","hprice":"535000","mallName":"네이버","productId":"22520082058","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b>8 64G (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=12666185860","image":"https://shopping-phinf.pstatic.net/main_1266618/12666185860.20180817145813.jpg","lprice":"208500","hprice":"434230","mallName":"네이버","productId":"12666185860","productType":"1","brand":"","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b> 11 Pro Max 256GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=20858558236","image":"https://shopping-phinf.pstatic.net/main_2085855/20858558236.20200220102302.jpg","lprice":"1361360","hprice":"1698900","mallName":"네이버","productId":"20858558236","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>7 128GB (LG U+)","link":"https://search.shopping.naver.com/gate.nhn?id=10310755106","image":"https://shopping-phinf.pstatic.net/main_1031075/10310755106.20161129114416.jpg","lprice":"10","hprice":"689600","mallName":"네이버","productId":"10310755106","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"LG U+","category4":""},{"title":"Apple <b>아이폰</b> 12 미니 256GB [SKT]","link":"https://search.shopping.naver.com/gate.nhn?id=24452854523","image":"https://shopping-phinf.pstatic.net/main_2445285/24452854523.20201014114759.jpg","lprice":"996300","hprice":"1160000","mallName":"네이버","productId":"24452854523","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>XR 256GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=16045980522","image":"https://shopping-phinf.pstatic.net/main_1604598/16045980522.20190618151440.jpg","lprice":"93000","hprice":"1062700","mallName":"네이버","productId":"16045980522","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b> 11 프로 맥스 512G [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=20858568206","image":"https://shopping-phinf.pstatic.net/main_2085856/20858568206.20200604142027.jpg","lprice":"1633040","hprice":"2600000","mallName":"네이버","productId":"20858568206","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 12 프로 512GB [SKT]","link":"https://search.shopping.naver.com/gate.nhn?id=24452979525","image":"https://shopping-phinf.pstatic.net/main_2445297/24452979525.20201014121947.jpg","lprice":"1579300","hprice":"1579300","mallName":"네이버","productId":"24452979525","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>7 32GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=10310329255","image":"https://shopping-phinf.pstatic.net/main_1031032/10310329255.20160908110948.jpg","lprice":"1","hprice":"1238700","mallName":"네이버","productId":"10310329255","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b> 11 128GB (LG U+)","link":"https://search.shopping.naver.com/gate.nhn?id=20858301860","image":"https://shopping-phinf.pstatic.net/main_2085830/20858301860.20190911112610.jpg","lprice":"807000","hprice":"1056000","mallName":"네이버","productId":"20858301860","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"LG U+","category4":""},{"title":"Apple <b>아이폰</b>XS Max 64GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=15989003724","image":"https://shopping-phinf.pstatic.net/main_1598900/15989003724.20181109110322.jpg","lprice":"815200","hprice":"1455800","mallName":"네이버","productId":"15989003724","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b>XS Max 256G [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=17071494387","image":"https://shopping-phinf.pstatic.net/main_1707149/17071494387.20191231163111.jpg","lprice":"1140000","hprice":"2151980","mallName":"네이버","productId":"17071494387","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b>8 Plus 64GB (KT)","link":"https://search.shopping.naver.com/gate.nhn?id=12666348287","image":"https://shopping-phinf.pstatic.net/main_1266634/12666348287.20180511145039.jpg","lprice":"42000","hprice":"1224400","mallName":"네이버","productId":"12666348287","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"KT","category4":""},{"title":"Apple <b>아이폰</b>8 256GB (SKT)","link":"https://search.shopping.naver.com/gate.nhn?id=12666242900","image":"https://shopping-phinf.pstatic.net/main_1266624/12666242900.20190208101230.jpg","lprice":"10","hprice":"1002600","mallName":"네이버","productId":"12666242900","productType":"1","brand":"Apple","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>XR 64G [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=17071491335","image":"https://shopping-phinf.pstatic.net/main_1707149/17071491335.20191231182407.jpg","lprice":"794000","hprice":"1390000","mallName":"네이버","productId":"17071491335","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""},{"title":"Apple <b>아이폰</b> 12 128GB [SKT]","link":"https://search.shopping.naver.com/gate.nhn?id=24451216531","image":"https://shopping-phinf.pstatic.net/main_2445121/24451216531.20201014115534.jpg","lprice":"996300","hprice":"1051050","mallName":"네이버","productId":"24451216531","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"SKT","category4":""},{"title":"Apple <b>아이폰</b>XR 128G [자급제]","link":"https://search.shopping.naver.com/gate.nhn?id=17071232018","image":"https://shopping-phinf.pstatic.net/main_1707123/17071232018.20190117165022.jpg","lprice":"893170","hprice":"1281870","mallName":"네이버","productId":"17071232018","productType":"1","brand":"아이폰","maker":"Apple","category1":"디지털/가전","category2":"휴대폰","category3":"자급제폰","category4":""}],
                items: [],
                count: 0,
                type: '검색전',
                progress: 0,
                cnt: 0,
            };
        }

        searchCallback = (dataChild) => {
            this.setState((prevState) => {
                return {
                    query: dataChild.query,
                    newItems: dataChild.items,
                }
            });
        }

        descriptionToCost = () => {
            let reals = [];
            this.state.items.map(item => {
                if (item.description.indexOf("가격") != -1 && item.description.indexOf("원") != -1 && ( item.description.indexOf("판매중") != -1) ) {
                    item.cost = item.description.split("가격")[1].split("원")[0].replace(/,/gi, "").replace(/ /g,"") * 1;
                    if (item.description.indexOf("판매중") != -1) item.type = "판매중";
                    if (item.description.indexOf("판매완료") != -1) item.type = "판매완료";
                    if (item.description.indexOf("예약중") != -1) item.type = "예약중";

                    this.setState((prevState) => {
                        return {
                            count: this.state.count + 1,
                            type: '검색중',
                        }
                    });

                    reals.push(item);
                }
            });

            reals.sort((a, b) => a.cost < b.cost ? -1 : a.cost > b.cost ? 1 : 0);

            this.setState((prevState) => {
                return {
                    items: reals.length == 0 ? [{}] : reals,
                }
            });
        }

        getData = async (e) => {

            e.preventDefault();

            $('.toast').toast({autohide : false});
            $('.toast').toast('show');

            this.setState((prevState) => {
                return {
                    items: [],
                    count: 0,
                    cnt: 0,
                    progress: 0,
                    type: '검색시작',
                }
            });

            await this.getData2(this.state.query, 1).then((responseObject) => {
                const date = new Date(responseObject.lastBuildDate);
                console.log(date);

                this.setState((prevState) => {
                    return {
                        lastBuildDate: date.getFullYear() + "." + (date.getMonth() + 1) + "." + date.getDate(),
                        total: responseObject.total,
                        start: responseObject.start,
                        display: responseObject.display,
                        items: this.state.items.concat(responseObject.items),
                        cnt: (responseObject.total / 100) > 5 ? 5 : (responseObject.total / 100),
                        progress: (100 / ((responseObject.total / 100) > 5 ? 5 : (responseObject.total / 100))) + this.state.progress,
                    }
                });

                $('.progress-bar').css('width', this.state.progress+'%');
            });

            this.descriptionToCost();

            for (let i = 1; i < this.state.cnt; i++) {
                await this.getData2(this.state.query, 100 * i).then((responseObject) => {
                    const date = new Date(responseObject.lastBuildDate);
                    console.log(date);

                    this.setState((prevState) => {
                        return {
                            items: this.state.items.concat(responseObject.items),
                            progress: (100 / this.state.cnt) + this.state.progress,
                        }
                    });
                    $('.progress-bar').css('width', this.state.progress+'%');
                });

                this.descriptionToCost();
            }

            this.setState((prevState) => {
                return {
                    type: '검색완료',
                }
            });

            $('.toast').toast('hide');
        }

        getData2 = (query, start) => new Promise(function(resolve, reject) {
            let request = new XMLHttpRequest();

            request.open('GET', 'http://3.21.35.236:8080/https://openapi.naver.com/v1/search/cafearticle?query=' + query + '&display=100&start=' + start + '&sort=sim', true);
            request.setRequestHeader('X-Naver-Client-Id', 'E73v0xFMsyAGr9GrOcID');
            request.setRequestHeader('X-Naver-Client-Secret', 'uvWTcWYkCv');
            request.setRequestHeader('Origin', 'http://3.21.35.236:8080');

            request.onload = (e) => {
                if (request.status >= 200 && request.status < 400) {
                    let responseObject = JSON.parse(request.responseText);
                    resolve(responseObject);
                } else {
                    console.log('We reached our target server, but it returned an error');
                    console.log('Possibly handle the error by changing your state.');
                }
            };

            request.onerror = () => {
                console.log('There was a connection error of some sort.');
                console.log('Possibly handle the error by changing your state.');
                reject();
            };

            request.send();
        });

        onChange = (e) => {
            this.setState({query:e.target.value});
        }

        render() {
            return (
                <React.Fragment>
                    <PriceComparisonTop searchCallback={this.searchCallback}></PriceComparisonTop>

                    <div style={{padding: '0.5rem 1rem'}}>
                        {this.state.newItems != 0
                            ? this.state.newItems.map(item => {
                                return (
                                    <PriceComparisonItem item={item}/>
                                )
                            })
                            : <div className="shadow-lg card p-2 mb-2 bg-white rounded align-middle p-1" style={{'text-align':'center', color:'var(--danger)', display:'block'}}>
                                <div className="spinner-border" role="status">
                                    <span className="sr-only">Loading...</span>
                                </div> <strong className="h5">Loading...</strong>
                            </div>
                        }
                    </div>
                </React.Fragment>
            );
        }
    }
</script>
<script type="text/babel">
    ReactDOM.render(<div className="cheapest_finder"><PriceComparison /></div>, document.querySelector('#root'));
</script>
</body>
</html>
